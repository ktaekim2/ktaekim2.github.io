---
layout: single
title: "66일차 배운 내용 정리-스프링부트(3)-테스트코드"
---

## 실습-테스트코드-update

### TestController.java

```java
@GetMapping("/update/{id}")
public String updateForm(@PathVariable("id") Long id, Model model) {
TestDTO testDTO = testService.findById(id);
model.addAttribute("updateDTO", testDTO);
return "update";
}

@PostMapping("/update")
public String update(@ModelAttribute TestDTO testDTO) {
Long updateId = testService.update(testDTO);
return "redirect:/" + updateId;
}
```

### TestEntity.java

```java
public static TestEntity toUpdateEntity(TestDTO testDTO) {
    TestEntity testEntity = new TestEntity();
    testEntity.setId(testDTO.getId());
    testEntity.setColumn1(testDTO.getColumn1());
    testEntity.setTestColumn2(testDTO.getTestColumn2());
    return testEntity;
}
```

### TestService.java

```java
public Long update(TestDTO testDTO) {
    // save 매서드 호출로 update 쿼리 가능(단, id가 같이 가야함)
    TestEntity testEntity = TestEntity.toUpdateEntity(testDTO);
    Long id = testRepository.save(testEntity).getId();
    return id;
}
```

### TestClass.java

```java
@Test
@DisplayName("수정 테스트")
@Transactional
@Rollback
public void updateTest() {
    /** 
        * 수정 테스트를 어떻게 할지 시나리오 써보고
        * assertThat().isNotEqualTo()
        */

    // 1. TestDTO 데이터를 저장하고 saveId를 리턴받음
    // 2. findById(saveId)로 수정전 TestDTO 가져옴
    // 3. 새로운 TestDTO 객체 선언하고 수정할 데이터를 저장함
    // 4. 새로만든 수정용 TestDTO에 saveId를 set함
    // 5. 수정용 TestDTO에 update 메서드 실행
    // 6. saveId로 수정후 TestDTO 가져옴
    // 7. 수정전 TestDTO와 수정후 TestDTO 비교

    TestDTO testDTO = new TestDTO("데이터1", "데이터2");
    Long saveId = testService.save(testDTO);
    TestDTO findDTO = testService.findById(saveId);
    TestDTO updateTestDTO = new TestDTO("수정데이터1", "수정데이터2");
    updateTestDTO.setId(saveId);
    testService.update(updateTestDTO);
    TestDTO updatedTestDTO = testService.findById(saveId);
    assertThat(findDTO.getColumn1()).isNotEqualTo(updatedTestDTO.getColumn1());
    assertThat(findDTO.getTestColumn2()).isNotEqualTo(updatedTestDTO.getTestColumn2());
}
```